(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function a(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(r){if(r.ep)return;r.ep=!0;const o=a(r);fetch(r.href,o)}})();function d(t){return t=t%360,t<0&&(t+=360),Math.round(t/90)*90}function g(t,e){return e===90||e===270?{newWidth:t.height,newHeight:t.width}:{newWidth:t.width,newHeight:t.height}}function m(t,e,a,n){e===90?(t.translate(a,0),t.rotate(Math.PI/2)):e===180?(t.translate(a,n),t.rotate(Math.PI)):e===270&&(t.translate(0,n),t.rotate(3*Math.PI/2))}function h(t,e,a,n){const r=document.createElement("canvas");r.width=e,r.height=a;const o=r.getContext("2d");o.save(),m(o,n,e,a);const i=f(t);return o.drawImage(i,0,0),o.restore(),o.getImageData(0,0,e,a)}function f(t){const e=document.createElement("canvas");return e.width=t.width,e.height=t.height,e.getContext("2d").putImageData(t,0,0),e}function p(t,e){const a=d(e);if(a===0||a===360)return t;const{newWidth:n,newHeight:r}=g(t,a);return h(t,n,r,a)}function I(t){return["image/jpeg","image/png","image/gif"].includes(t.type)}function y(t,e,a){const n=new Image;n.onload=()=>D(n,e),n.onerror=()=>a(new Error("Error loading image")),n.src=t}function D(t,e){const a=document.createElement("canvas");a.width=t.width,a.height=t.height;const n=a.getContext("2d");n.drawImage(t,0,0);const r=n.getImageData(0,0,t.width,t.height);e(r)}function P(t){return new Promise((e,a)=>{I(t)||a(new Error("Invalid image file"));const n=new FileReader;n.onload=()=>y(n.result,e,a),n.onerror=()=>a(new Error("Error reading image file")),n.readAsDataURL(t)})}function u(t){return new ImageData(new Uint8ClampedArray(t.data),t.width,t.height)}function c(t,e){const a=u(t),n=a.data;for(let r=0;r<n.length;r+=4){const[o,i,l]=e(n[r],n[r+1],n[r+2]);n[r]=o,n[r+1]=i,n[r+2]=l}return a}function s(t){return Math.min(255,Math.max(0,t))}function w(t){return c(t,(a,n,r)=>{const o=.299*a+.587*n+.114*r;return[o,o,o]})}function v(t,e){const a=e/100*255;return c(t,(r,o,i)=>[s(r+a),s(o+a),s(i+a)])}function x(t,e){const a=259*(e+255)/(255*(259-e));return c(t,(r,o,i)=>[s(a*(r-128)+128),s(a*(o-128)+128),s(a*(i-128)+128)])}function C(t,e=50){return c(t,(n,r,o)=>{const i=(Math.random()*2-1)*e;return[s(n+i),s(r+i),s(o+i)]})}function E(t){return c(t,(a,n,r)=>[255-a,255-n,255-r])}class M{constructor(e){this.imageData=e,this.originalImageData=u(e)}rotate(e){this.imageData=p(this.imageData,e)}reset(){this.imageData=u(this.originalImageData)}grayScale(){this.imageData=w(this.imageData)}brightness(e){this.imageData=v(this.originalImageData,e)}contrast(e){this.imageData=x(this.originalImageData,e)}noise(e){this.imageData=C(this.imageData,e)}invert(){this.imageData=E(this.imageData)}getImageData(){return this.imageData}}export{M as I,P as l};
