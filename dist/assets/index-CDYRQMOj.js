(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function n(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(a){if(a.ep)return;a.ep=!0;const o=n(a);fetch(a.href,o)}})();function y(t){return t=t%360,t<0&&(t+=360),Math.round(t/90)*90}function v(t,e){return e===90||e===270?{newWidth:t.height,newHeight:t.width}:{newWidth:t.width,newHeight:t.height}}function x(t,e,n,r){e===90?(t.translate(n,0),t.rotate(Math.PI/2)):e===180?(t.translate(n,r),t.rotate(Math.PI)):e===270&&(t.translate(0,r),t.rotate(3*Math.PI/2))}function D(t,e,n,r){const a=document.createElement("canvas");a.width=e,a.height=n;const o=a.getContext("2d");o.save(),x(o,r,e,n);const c=E(t);return o.drawImage(c,0,0),o.restore(),o.getImageData(0,0,e,n)}function E(t){const e=document.createElement("canvas");return e.width=t.width,e.height=t.height,e.getContext("2d").putImageData(t,0,0),e}function w(t,e){const n=y(e);if(n===0||n===360)return t;const{newWidth:r,newHeight:a}=v(t,n);return D(t,r,a,n)}function C(t){return["image/jpeg","image/png","image/gif"].includes(t.type)}function B(t,e,n){const r=new Image;r.onload=()=>L(r,e),r.onerror=()=>n(new Error("Error loading image")),r.src=t}function L(t,e){const n=document.createElement("canvas");n.width=t.width,n.height=t.height;const r=n.getContext("2d");r.drawImage(t,0,0);const a=r.getImageData(0,0,t.width,t.height);e(a)}function h(t){return new Promise((e,n)=>{C(t)||n(new Error("Invalid image file"));const r=new FileReader;r.onload=()=>B(r.result,e,n),r.onerror=()=>n(new Error("Error reading image file")),r.readAsDataURL(t)})}function m(t){return new ImageData(new Uint8ClampedArray(t.data),t.width,t.height)}function u(t,e){const n=m(t),r=n.data;for(let a=0;a<r.length;a+=4){const[o,c,I]=e(r[a],r[a+1],r[a+2]);r[a]=o,r[a+1]=c,r[a+2]=I}return n}function l(t){return Math.min(255,Math.max(0,t))}function T(t){return u(t,(n,r,a)=>{const o=.299*n+.587*r+.114*a;return[o,o,o]})}function b(t,e){const n=e/100*255;return u(t,(a,o,c)=>[l(a+n),l(o+n),l(c+n)])}function M(t,e){const n=259*(e+255)/(255*(259-e));return u(t,(a,o,c)=>[l(n*(a-128)+128),l(n*(o-128)+128),l(n*(c-128)+128)])}function P(t,e=50){return u(t,(r,a,o)=>{const c=(Math.random()*2-1)*e;return[l(r+c),l(a+c),l(o+c)]})}function A(t){return u(t,(n,r,a)=>[255-n,255-r,255-a])}class f{constructor(e){this.imageData=e,this.originalImageData=m(e)}rotate(e){this.imageData=w(this.imageData,e)}reset(){this.imageData=m(this.originalImageData)}grayScale(){this.imageData=T(this.imageData)}brightness(e){this.imageData=b(this.originalImageData,e)}contrast(e){this.imageData=M(this.originalImageData,e)}noise(e){this.imageData=P(this.imageData,e)}invert(){this.imageData=A(this.imageData)}getImageData(){return this.imageData}}const p=document.getElementById("fileInput"),F=document.getElementById("rotateButton"),R=document.getElementById("resetButton"),k=document.getElementById("grayScaleButton"),O=document.getElementById("contrastInput"),S=document.getElementById("brightnessInput"),j=document.getElementById("noiseButton"),N=document.getElementById("invertButton"),s=document.getElementById("errorMessage"),U=document.getElementById("saveButton"),g=document.getElementById("canvas"),q=g.getContext("2d",{willREADFrequently:!0});let i;["dragenter","dragover","dragleave","drop"].forEach(t=>{g.addEventListener(t,e=>{e.preventDefault(),e.stopPropagation()})});g.addEventListener("drop",async t=>{const e=t.dataTransfer.files[0];if(e)try{const n=await h(e);i=new f(n),d(i.getImageData())}catch(n){console.error(n),s.textContent="Invalid image file, try png or jpg"}});g.addEventListener("click",()=>p.click());p.addEventListener("change",async t=>{const e=t.target.files[0];try{const n=await h(e);i=new f(n),d(i.getImageData())}catch(n){console.error(n),s.textContent="Invalid image file, try png or jpg"}});F.addEventListener("click",()=>{i?(s.textContent="",i.rotate(90),d(i.getImageData())):s.textContent="There is none image to rotate"});k.addEventListener("click",()=>{i?(s.textContent="",i.grayScale(),d(i.getImageData())):s.textContent="There is none image to apply grayscale"});j.addEventListener("click",()=>{i?(s.textContent="",i.noise(),d(i.getImageData())):s.textContent="There is none image to apply noise"});N.addEventListener("click",()=>{i?(s.textContent="",i.invert(),d(i.getImageData())):s.textContent="There is none image to invert"});S.addEventListener("input",t=>{if(i){const e=parseInt(t.target.value,10);i.brightness(e),d(i.getImageData())}else s.textContent="There is none image to adjust brightness"});O.addEventListener("input",t=>{if(i){s.textContent="";const e=parseFloat(t.target.value);i.contrast(e),d(i.getImageData())}else s.textContent="There is none image to adjust contrast"});R.addEventListener("click",()=>{i?(s.textContent="",i.reset(),d(i.getImageData())):s.textContent="There is none image to reset"});U.addEventListener("click",()=>{if(i){s.textContent="";const t=document.createElement("a");t.download="edited_image.png",t.href=g.toDataURL("image/png"),t.click()}else s.textContent="There is none image to save"});function G(){const t=g.getContext("2d");t.clearRect(0,0,g.width,g.height),t.fillStyle="#888",t.font="20px Arial",t.textAlign="center",t.fillText("Drop and drop an image or click to upload",g.width/2,g.height/2)}function d(t){g.width=t.width,g.height=t.height,s.textContent="",q.putImageData(t,0,0)}g.width=800;g.height=600;G();
